(()=>{"use strict";function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.header=document.createElement("header"),this.title=this.header.appendChild(document.createElement("h1")),this.title.textContent="Virtual keyboard",this.title.classList.add("title")}var a,r;return a=t,(r=[{key:"getHeaderElement",value:function(){return this.header}}])&&e(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),t}();const a={L_SHIFT_KEY:"ShiftLeft",R_SHIFT_KEY:"ShiftRight",L_CTRL_KEY:"ControlLeft",R_CTRL_KEY:"ControlRight",OS_KEY:"OS_LEFT",L_ALT_KEY:"AltLeft",R_ALT_KEY:"AltRight",BACKSPACE_KEY:"Backspace",CAPS_LOCK_KEY:"CapsLock",ENTER_KEY:"Enter",LEFT_ARROW_KEY:"ArrowLeft",RIGHT_ARROW_KEY:"ArrowRight",UP_ARROW_KEY:"ArrowUp",DOWN_ARROW_KEY:"ArrowDown",TAB_KEY:"Tab",KEYBOARD_STATE:{caseDown:"caseDown",caseUp:"caseUp",caps:"caps",shiftCaps:"shiftCaps"},LANGS:{eng:"eng",rus:"rus"},KEY_NAMES:[["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","NumpadSubtract","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash"],["CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","NumpadDecimal","Period","Slash","ArrowUp","ShiftRight"],["ControlLeft","OSLeft","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"]],LAYOUTS:{eng:{caseDown:[["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace"],["Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\"],["Caps Lock","a","s","d","f","g","h","j","k","l",";","'","Enter"],["Shift","z","x","c","v","b","n","m",",",".","/","▲","rShift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]],caseUp:[["~","!","@","#","$","%","^","&","*","(",")","_","+","Backspace"],["Tab","Q","W","E","R","T","Y","U","I","O","P","{","}","|"],["Caps Lock","A","S","D","F","G","H","J","K","L",":",'"',"Enter"],["Shift","Z","X","C","V","B","N","M","<",">","?","▲","rShift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]],caps:[["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace"],["Tab","Q","W","E","R","T","Y","U","I","O","P","[","]","\\"],["Caps Lock","A","S","D","F","G","H","J","K","L",";","'","Enter"],["Shift","Z","X","C","V","B","N","M",",",".","/","▲","rShift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]],shiftCaps:[["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace"],["Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\"],["Caps Lock","a","s","d","f","g","h","j","k","l",";","'","Enter"],["Shift","z","x","c","v","b","n","m",",",".","/","▲","rShift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]]},rus:{caseDown:[["ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace"],["Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\"],["Caps Lock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter"],["Shift","я","ч","с","м","и","т","ь","б","ю",".","▲","Shift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]],caseUp:[["Ё","!",'"',"№",";","%",":","?","*","(",")","_","+","Backspace"],["Tab","Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ","/"],["Caps Lock","Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э","Enter"],["Shift","Я","Ч","С","М","И","Т","Ь","Б","Ю",",","▲","Shift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]],caps:[["ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace"],["Tab","Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ","\\"],["Caps Lock","Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э","Enter"],["Shift","Я","Ч","С","М","И","Т","Ь","Б","Ю",".","▲","Shift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]],shiftCaps:[["ё","!",'"',"№",";","%",":","?","*","(",")","_","+","Backspace"],["Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\"],["Caps Lock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter"],["Shift","я","ч","с","м","и","т","ь","б","ю",",","▲","Shift"],["Ctrl","Win","Alt"," ","Alt","◄","▼","►","Ctrl"]]}}};function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyboard=t,this.textarea=r;var i=this.textarea.getTextareaElement();this.backspaceEventHandler=function(){i.focus();var e=i.selectionStart;i.value="".concat(i.value.slice(0,e-1)).concat(i.value.slice(e)),i.selectionEnd=e-1,i.selectionStart=e-1},this.lShiftEventHandler=function(e){n.keyboard.leftShiftKeyPressed=!n.keyboard.leftShiftKeyPressed,n.keyboard.updateState(),n.keyboard.updateKeyboardElements(),e.currentTarget.classList.toggle("active"),n.keyboard.updateState()},this.rShiftEventHandler=function(e){n.keyboard.rightShiftKeyPressed=!n.keyboard.rightShiftKeyPressed,n.keyboard.updateState(),n.keyboard.updateKeyboardElements(),e.currentTarget.classList.toggle("active"),n.keyboard.updateState()},this.capsLockHandler=function(e){n.keyboard.capsLockPressed=!n.keyboard.capsLockPressed,n.keyboard.updateState(),n.keyboard.updateKeyboardElements(),e.currentTarget.classList.toggle("active"),n.keyboard.updateState()},this.lCtrlEventHandler=function(e){n.keyboard.ctrlPress=!n.keyboard.leftCtrlPress;var t=e.currentTarget;t.classList.toggle("active"),(n.keyboard.leftAltPressed||n.keyboard.rightAltPressed)&&(n.keyboard.switchLanguage(),n.keyboard.updateKeyboardElements(),t.classList.remove("active"),document.querySelector(".keyboard__key[data-key=".concat(a.L_ALT_KEY,"]")).classList.remove("active"),document.querySelector(".keyboard__key[data-key=".concat(a.R_ALT_KEY,"]")).classList.remove("active"),n.keyboard.leftAltPressed=!1,n.keyboard.rightAltElement=!1,n.keyboard.leftCtrlPressed=!1),n.keyboard.updateState()},this.rCtrlEventHandler=function(e){n.keyboard.ctrlPress=!n.keyboard.rightCtrlPress,e.currentTarget.classList.toggle("active"),n.keyboard.updateState()},this.lAltEventHandler=function(e){n.keyboard.leftAltPressed=!n.keyboard.leftAltPressed,e.currentTarget.classList.toggle("active"),n.keyboard.updateState()},this.rAltEventHandler=function(e){n.keyboard.rightAltPressed=!n.keyboard.rightAltPressed,e.currentTarget.classList.toggle("active"),n.keyboard.updateState()},this.keyEventHandler=function(e){var t=n.keyboard.getKeyboardState(),a=e.currentTarget;a.classList.add("active"),setTimeout((function(e){a.classList.remove(e)}),100,"active");var r=(a.classList.contains("".concat(t))?a:a.querySelector(".".concat(n.keyboard.keyboardLang," > .").concat(t))).textContent;i.focus();var s=i.selectionStart;i.value="".concat(i.value.slice(0,i.selectionStart)).concat(r).concat(i.value.slice(i.selectionStart)),i.selectionStart=s+1,i.selectionEnd=s+1},this.windowKeyDownEventHandler=function(e){e.preventDefault(),document.querySelector(".keyboard__key[data-key=".concat(e.code,"]")).dispatchEvent(new Event("click"))},this.tabKeyHandler=function(){i.focus();var e=i.selectionStart;i.value="".concat(i.value.slice(0,i.selectionStart),"    ").concat(i.value.slice(i.selectionStart)),i.selectionStart=e+4,i.selectionEnd=e+4},this.enterKeyHandler=function(){i.focus();var e=i.selectionStart;i.value="".concat(i.value.slice(0,i.selectionStart),"\n\r").concat(i.value.slice(i.selectionStart)),i.selectionStart=e+1,i.selectionEnd=e+1},this.arrowKeyHandler=function(e){var t=e.currentTarget;i.focus();var r=i.selectionStart;switch(t.classList.add("active"),setTimeout((function(e){t.classList.remove(e)}),100,"active"),t.getAttribute("data-key")){case a.LEFT_ARROW_KEY:i.selectionStart=r-1,i.selectionEnd=r-1;break;case a.RIGHT_ARROW_KEY:i.selectionStart=r+1,i.selectionEnd=r+1}if(t.getAttribute("data-key")===a.UP_ARROW_KEY){var n="\n"===i.value[r]?i.value.lastIndexOf("\n",r-1):i.value.lastIndexOf("\n",r),s=i.value.lastIndexOf("\n",n-1);if(-1===n)return;var c=r-n;i.selectionEnd=c+s,i.selectionStart=c+s}if(t.getAttribute("data-key")===a.DOWN_ARROW_KEY){var o="\n"===i.value[r]?i.value.lastIndexOf("\n",r-1):i.value.lastIndexOf("\n",r),l=i.value.lastIndexOf("\n",r+1);if(-1===l)return;var d=r-o;i.selectionEnd=d+l,i.selectionStart=d+l}}}var t,n;return t=e,(n=[{key:"attachEventsToKeys",value:function(){var e=this;this.keyboard.getKeyElementsArray().forEach((function(t){switch(t.getAttribute("data-key")){case a.L_SHIFT_KEY:t.addEventListener("click",e.lShiftEventHandler);break;case a.R_SHIFT_KEY:t.addEventListener("click",e.rShiftEventHandler);break;case a.CAPS_LOCK_KEY:t.addEventListener("click",e.capsLockHandler);break;case a.L_ALT_KEY:t.addEventListener("click",e.lAltEventHandler);break;case a.R_ALT_KEY:t.addEventListener("click",e.rAltEventHandler);break;case a.R_CTRL_KEY:t.addEventListener("click",e.rCtrlEventHandler);break;case a.L_CTRL_KEY:t.addEventListener("click",e.lCtrlEventHandler);break;case a.BACKSPACE_KEY:t.addEventListener("click",e.backspaceEventHandler);break;case a.ENTER_KEY:t.addEventListener("click",e.enterKeyHandler);break;case a.LEFT_ARROW_KEY:case a.RIGHT_ARROW_KEY:case a.UP_ARROW_KEY:case a.DOWN_ARROW_KEY:t.addEventListener("click",e.arrowKeyHandler);break;case a.TAB_KEY:t.addEventListener("click",e.tabKeyHandler);break;default:t.addEventListener("click",e.keyEventHandler)}}))}},{key:"attachEventToWindow",value:function(){document.addEventListener("keydown",this.windowKeyDownEventHandler)}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.leftShiftKeyPressed=!1,this.rightShiftKeyPressed=!1,this.capsLockPressed=!1,this.leftAltPressed=!1,this.rightAltPressed=!1,this.leftCtrlPressed=!1,this.rightCtrlPressed=!1,this.keyboardLang=sessionStorage.getItem("lang")?sessionStorage.getItem("lang"):a.LANGS.eng,sessionStorage.setItem("lang",this.keyboardLang),this.keyboard=document.createElement("div"),this.keyboard.classList.add("keyboard"),this.keyboardState=a.KEYBOARD_STATE.caseDown,this.keyElementsArray=[];for(var r=function(e){var r=t.keyboard.appendChild(document.createElement("div"));r.classList.add("keyboard__row");for(var n=function(n){var i=r.appendChild(document.createElement("div"));i.classList.add("keyboard__key","key","".concat(a.KEY_NAMES[e][n])),i.setAttribute("data-key","".concat(a.KEY_NAMES[e][n])),t.keyElementsArray.push(i),Object.keys(a.LAYOUTS).forEach((function(t,r){var s=i.appendChild(document.createElement("span"));s.classList.add(t),r>0&&s.classList.add("hidden");var c=s.appendChild(document.createElement("span"));c.textContent=a.LAYOUTS[t].caseDown[e][n],c.classList.add("caseDown");var o=s.appendChild(document.createElement("span"));o.textContent=a.LAYOUTS[t].caseUp[e][n],o.classList.add("caseUp","hidden");var l=s.appendChild(document.createElement("span"));l.textContent=a.LAYOUTS[t].caps[e][n],l.classList.add("caps","hidden");var d=s.appendChild(document.createElement("span"));d.textContent=a.LAYOUTS[t].shiftCaps[e][n],d.classList.add("shiftCaps","hidden")}))},i=0;i<a.LAYOUTS.eng.caseDown[e].length;i+=1)n(i)},n=0;n<a.LAYOUTS.eng.caseDown.length;n+=1)r(n);this.updateKeyboardElements()}var t,r;return t=e,(r=[{key:"getKeyboardElement",value:function(){return this.keyboard}},{key:"getKeyElementsArray",value:function(){return this.keyElementsArray}},{key:"getKeyboardState",value:function(){return this.keyboardState}},{key:"setKeyboardState",value:function(e){this.keyboardState=e}},{key:"updateState",value:function(){var e=this.leftShiftKeyPressed||this.rightShiftKeyPressed;e||this.capsLockPressed||this.setKeyboardState(a.KEYBOARD_STATE.caseDown),e&&!this.capsLockPressed&&this.setKeyboardState(a.KEYBOARD_STATE.caseUp),!e&&this.capsLockPressed&&this.setKeyboardState(a.KEYBOARD_STATE.caps),e&&this.capsLockPressed&&this.setKeyboardState(a.KEYBOARD_STATE.shiftCaps)}},{key:"updateKeyboardElements",value:function(){var e=this;this.keyElementsArray.forEach((function(t){var a=t.children;Array.from(a).forEach((function(t){t.classList.add("hidden"),t.classList.contains(e.keyboardLang)&&t.classList.remove("hidden"),Array.from(t.children).forEach((function(e){e.classList.add("hidden")}))})),Array.from(t.querySelectorAll(".".concat(e.keyboardState))).forEach((function(e){e.classList.remove("hidden")}))}))}},{key:"switchLanguage",value:function(){this.keyboardLang===a.LANGS.eng?(this.keyboardLang=a.LANGS.rus,sessionStorage.setItem("lang",a.LANGS.rus)):(this.keyboardLang=a.LANGS.eng,sessionStorage.setItem("lang",a.LANGS.eng))}}])&&i(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textareaContainer=document.createElement("div"),this.textarea=this.textareaContainer.appendChild(document.createElement("textarea")),this.textarea.classList.add("body__textarea","textarea")}var t,a;return t=e,(a=[{key:"getTextareaContainer",value:function(){return this.textareaContainer}},{key:"getTextareaElement",value:function(){return this.textarea}}])&&c(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=document.createElement("main"),this.main.classList.add("body__main");var t=new o,a=t.getTextareaContainer();this.main.appendChild(a);var r=new s,i=r.getKeyboardElement();this.main.appendChild(i);var c=this.main.appendChild(document.createElement("div"));c.textContent="Клавиатура создана в операционной системе Windows",c.classList.add("main__description");var l=this.main.appendChild(document.createElement("div"));l.textContent="Для переключения языка комбинация: левые alt + ctrl",l.classList.add("main__switch-lang");var d=new n(r,t);d.attachEventsToKeys(),d.attachEventToWindow()}var t,a;return t=e,(a=[{key:"getMainElement",value:function(){return this.main}}])&&l(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.footer=document.createElement("footer"),this.copyright=this.footer.appendChild(document.createElement("div")),this.copyright.classList.add("copyright"),this.copyright.textContent="© 2022"}var t,a;return t=e,(a=[{key:"getFooterElement",value:function(){return this.footer}}])&&u(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),e}(),h=document.getElementsByTagName("body")[0].appendChild(document.createElement("div"));h.classList.add("body__wrapper");var f=(new t).getHeaderElement();h.appendChild(f);var E=(new d).getMainElement();h.appendChild(E);var v=(new y).getFooterElement();h.appendChild(v)})();